<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1, maximum-scale=1, user-scalable=no, viewport-fit=cover" />
<title>–û–ø–ª–∞—á–µ–Ω–æ ‚Äî RideNow</title>
<style>
  :root{
    --ink:#eaf2ff; --muted:#a6b5cc; --stroke:rgba(255,255,255,.18);
    --glass-1:rgba(14,21,26,.55); --glass-2:rgba(14,21,26,.35);
    --g1:#ffb668; --g2:#9de9d7; --gutter:16px;
  }
  *{box-sizing:border-box}
  html,body{height:100dvh;margin:0;overflow:hidden;overscroll-behavior:none;-webkit-text-size-adjust:100%}
  body{
    color:var(--ink); font-family:ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,"Helvetica Neue",Arial;
    background:linear-gradient(180deg,rgba(0,0,0,.65),rgba(0,0,0,.55) 35%,rgba(0,0,0,.45) 60%,rgba(0,0,0,.55)),url("image.png") center/cover fixed;
    display:grid; grid-template-rows:1fr auto;
  }
  main{display:grid; place-items:center; padding:var(--gutter)}
  .panel{
    width:min(760px,calc(100vw - var(--gutter)*2));
    border:1px solid var(--stroke); border-radius:22px;
    background:linear-gradient(180deg,var(--glass-1),var(--glass-2));
    box-shadow:0 30px 80px rgba(0,0,0,.45), inset 0 1px 0 rgba(255,255,255,.22);
    padding:16px; backdrop-filter: blur(14px) saturate(140%);
    text-align:center;
  }
  h2{margin:0 0 12px}
  .trip{border:1px solid var(--stroke); border-radius:12px; padding:10px; opacity:.95}
  .pill{display:inline-grid; place-items:center; padding:8px 12px; border-radius:14px; font-weight:900; background:linear-gradient(90deg,#ffb668,#9de9d7); color:#072e12; margin:12px 0}
  .note{font-size:14px; color:#cfe3ff}
  .cta{margin-top:14px; height:52px; width:100%; border:0; border-radius:14px; cursor:pointer;
       font-weight:900; font-size:18px; color:#0b0f12; background:linear-gradient(90deg,var(--g1),var(--g2)); box-shadow:0 10px 24px rgba(183,167,255,.25)}
  /* bottom nav */
  .bottom{padding:0 env(safe-area-inset-right) env(safe-area-inset-bottom) env(safe-area-inset-left)}
  .bar{display:flex;justify-content:space-around;background:var(--glass-2);border-radius:20px 20px 0 0;padding:8px;backdrop-filter:blur(12px)}
  .tab{flex:1;text-align:center;color:var(--ink);font-size:12px;text-decoration:none;padding:6px 0}
  .tab .ico{font-size:18px;display:block}
  .tab.active{color:var(--g1)}
</style>
</head>
<body>
  <main>
    <div class="panel" role="alertdialog" aria-label="–û–ø–ª–∞—Ç–∞ –ø—Ä–æ—à–ª–∞ —É—Å–ø–µ—à–Ω–æ">
      <h2>–ì–æ—Ç–æ–≤–æ! –û–ø–ª–∞—Ç–∞ –ø—Ä–æ—à–ª–∞ —É—Å–ø–µ—à–Ω–æ</h2>
      <div class="trip" id="tripLine">–ö–∏–µ–≤ ‚Äî –û–¥–µ—Å—Å–∞ ‚Ä¢ 16.09.2025</div>
      <div class="pill">–û–ø–ª–∞—á–µ–Ω–æ: 25 ‚Ç¥</div>
      <div class="note" id="cashNote" style="margin-bottom:10px">–í–æ–¥–∏—Ç–µ–ª—é –Ω–∞–ª–∏—á–Ω—ã–º–∏ –ø—Ä–∏ –ø–æ—Å–∞–¥–∫–µ: 550 ‚Ç¥.</div>
      <div class="note">–í—ã –æ–ø–ª–∞—Ç–∏–ª–∏ —Å–µ—Ä–≤–∏—Å–Ω—ã–π —Å–±–æ—Ä ‚Äî –æ–Ω –∏–¥—ë—Ç –Ω–∞ —Ä–∞–∑–≤–∏—Ç–∏–µ RideNow. –ü–æ–µ–∑–¥–∫–∞ —É–∂–µ –≤ ¬´–ê–∫—Ç—É–∞–ª—å–Ω—ã—Ö¬ª. –û–∂–∏–¥–∞–π—Ç–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –æ—Ç –≤–æ–¥–∏—Ç–µ–ª—è (–¥–æ ~1 —á–∞—Å–∞).</div>
      <button class="cta" id="toActual">–ü–µ—Ä–µ–π—Ç–∏ –≤ ¬´–ê–∫—Ç—É–∞–ª—å–Ω—ã–µ¬ª</button>
    </div>
  </main>

  <nav class="bottom" aria-label="–ù–∞–≤–∏–≥–∞—Ü–∏—è">
    <div class="bar">
      <a class="tab" href="passenger-profile.html"><div class="ico">üë§</div>–ü—Ä–æ—Ñ–∏–ª—å</a>
      <a class="tab" href="passenger-wallet.html"><div class="ico">üí≥</div>–ö–æ—à–µ–ª—ë–∫</a>
      <a class="tab active" href="passenger-active.html"><div class="ico">üöó</div>–ê–∫—Ç—É–∞–ª—å–Ω–∞—è</a>
      <a class="tab" href="passenger-search.html"><div class="ico">üîç</div>–ü–æ–∏—Å–∫</a>
    </div>
  </nav>

  <script>
    // ===== helpers –¥–ª—è –∫–æ—à–µ–ª—å–∫–∞/–∫—Ä–µ–¥–∏—Ç–∞
    const CREDIT_KEY = 'rn:svcfee:credit';
    const bookingKey = 'rn:booking:active';

    const creditGet = () => { try { return JSON.parse(localStorage.getItem(CREDIT_KEY)); } catch { return null } };
    const creditSet = (v) => localStorage.setItem(CREDIT_KEY, JSON.stringify(v));

    function creditGrantLocked(tripId, amount=25){
      const c = creditGet() || {};
      c.amount = amount;
      c.state = 'locked';                 // –∂–¥—ë–º –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è
      c.lockedForTripId = tripId;
      c.lockedAt = Date.now();
      c.expiresAt = Date.now() + 60*60*1000; // 1 —á–∞—Å
      creditSet(c);
    }

    // ===== —á–∏—Ç–∞–µ–º –ø–∞—Ä–∞–º–µ—Ç—Ä—ã (–µ—Å—Ç—å –¥–µ—Ñ–æ–ª—Ç—ã, —á—Ç–æ–±—ã –¥–µ–º–æ –∂–∏–ª–æ –æ—Ç–¥–µ–ª—å–Ω–æ)
    const qs = new URLSearchParams(location.search);
    const tripId = qs.get('tripId') || 'kyiv-odesa';
    const from   = qs.get('from')   || '–ö–∏–µ–≤';
    const to     = qs.get('to')     || '–û–¥–µ—Å—Å–∞';
    const date   = qs.get('date')   || '16.09.2025';
    const cash   = Number(qs.get('cash')||550);

    // –ø–æ–¥—Å—Ç–∞–≤–∏–º —Ç–µ–∫—Å—Ç—ã
    document.getElementById('tripLine').textContent = `${from} ‚Äî ${to} ‚Ä¢ ${date}`;
    document.getElementById('cashNote').textContent = `–í–æ–¥–∏—Ç–µ–ª—é –Ω–∞–ª–∏—á–Ω—ã–º–∏ –ø—Ä–∏ –ø–æ—Å–∞–¥–∫–µ: ${cash} ‚Ç¥.`;

    // —Ñ–∞–∫—Ç –æ–ø–ª–∞—Ç—ã (–∏–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ)
    localStorage.setItem('rn:paid:'+tripId, JSON.stringify({ paid:1, paidAt:Date.now() }));

    // –∫—Ä–µ–¥–∏—Ç —Å–µ—Ä–≤.—Å–±–æ—Ä–∞ -> –∫–æ—à–µ–ª—ë–∫ (–ø—Ä–∏–≤—è–∑–∞–Ω –∫ —ç—Ç–æ–π –ø–æ–µ–∑–¥–∫–µ –Ω–∞ 1 —á–∞—Å)
    creditGrantLocked(tripId, 25);

    // ¬´–ê–∫—Ç—É–∞–ª—å–Ω–∞—è¬ª: —Å–æ–∑–¥–∞—ë–º/–æ–±–Ω–æ–≤–ª—è–µ–º –æ–∂–∏–¥–∞–Ω–∏–µ
    const active = {
      id: tripId,
      from, to, date, cash,
      status: 'pending',       // –∂–¥—ë–º –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –≤–æ–¥–∏—Ç–µ–ª—è
      createdAt: Date.now()
    };
    localStorage.setItem(bookingKey, JSON.stringify(active));

    // –∫–Ω–æ–ø–∫–∞ –ø–µ—Ä–µ—Ö–æ–¥–∞
    document.getElementById('toActual').onclick = () => location.href = 'passenger-actual.html?tripId='+encodeURIComponent(tripId);
  </script>
</body>
</html>
